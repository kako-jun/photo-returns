# PhotoReturns

**Take back your memories - 思い出を取り戻そう**

PhotoReturns は、EXIFメタデータに基づいて写真や動画を整理・リネームするクロスプラットフォームアプリケーションです。クラウドサービスからデジタルな思い出の所有権を取り戻しましょう。

## 機能

### コア機能
- **EXIF ベースのリネーム** - 撮影日時メタデータを使って自動的にファイルをリネーム
- **ディレクトリ階層** - `YYYY/YYYYMM/YYYYMMDD` 構造でファイルを整理
- **マルチフォーマット対応**
  - 画像10形式: JPG, PNG, GIF, BMP, HEIC, HEIF, WebP, TIFF
  - 動画11形式: MP4, MOV, AVI, MKV, WMV, FLV, WebM, M4V, 3GP, MPG, MPEG
- **複数の日付ソース** - EXIF、ファイル名、作成日時、更新日時から選択可能
- **タイムゾーン調整** - 写真と動画で個別にタイムゾーンを設定可能

### 自動機能
- **バースト検出** - 連続撮影写真（3秒以内に3枚以上）を識別して連番を付与
- **EXIF 回転補正** - EXIF の Orientation タグに基づいて自動的に画像を回転し、タグをリセット
- **回転プレビュー** - Before/After カラムで回転前後の画像を確認
- **並列処理** - マルチスレッドによる高速スキャン・処理
- **一時ファイルクリーンアップ** - 処理後に一時ファイルを自動削除

### ユーザーインターフェース
- **詳細データグリッド（11列）**
  - サムネイル - クリックでライトボックス表示
  - Type - 写真/動画バッジ
  - Original Name - 元のファイル名
  - New Name - 新しいファイル名のプレビュー
  - Date Source - 日付ソースの選択（行毎に設定可能）
  - Date Taken - 撮影日時の表示
  - Size - ファイルサイズ
  - EXIF Rotation - 検出された回転角度
  - Before - 回転前のプレビュー
  - After - 回転後のプレビュー
  - Actions - 行の展開/折りたたみボタン
- **デフォルト設定** - 写真と動画で別々のデフォルト設定（日付ソース、タイムゾーン、回転モード）
- **処理フロー表示** - 各ファイルの処理ステップを視覚的に表示
- **包括的なログシステム** - すべての処理をログに記録し、モーダルで確認可能
- **エラーハンドリング**
  - ディレクトリ検証（入力/出力の関係チェック）
  - 処理サマリー表示（成功/失敗/スキップのカウント）
  - 失敗ファイルへのスクロール機能
  - 失敗ファイルのみ再処理するボタン
- **ダークモード** - 自動的なダーク/ライトテーマ対応
- **レスポンシブデザイン** - モダンな Tailwind CSS スタイリング
- **スムーズなスクロール** - トップに戻るボタン付き

## なぜ PhotoReturns？

### 問題
- クラウドサービスは容量制限で課金を迫る
- 写真が人質に取られ、自由にアクセスできない
- オフライン環境で使えない
- プライバシーの懸念

### PhotoReturns の解決策
- ✅ **完全ローカル** - ネットワーク通信なし、プライバシー保護
- ✅ **標準フォーマット** - 日付ベースの普遍的なディレクトリ構造
- ✅ **クラウド非依存** - 自分のストレージに完全コントロール
- ✅ **バックアップ容易** - 構造化されたファイルで簡単にバックアップ
- ✅ **無料** - 課金なし、制限なし

## インストール

リリースページから最新版のバイナリをダウンロードしてください。

- **Windows**: `PhotoReturns.exe`
- **macOS**: `PhotoReturns.app`
- **Linux**: `PhotoReturns.AppImage` または `.deb` / `.rpm`

ダウンロード後、実行するだけで使用できます。

## 使い方

### 基本ワークフロー

1. **入力ディレクトリを選択** - 写真・動画が入っているフォルダを選択
2. **出力ディレクトリを選択** - 整理されたファイルを保存する場所を選択
3. **デフォルト設定を調整（オプション）**
   - 写真のデフォルト: 日付ソース（Exif推奨）、タイムゾーン、回転モード
   - 動画のデフォルト: 日付ソース（FileModified推奨）、タイムゾーン、回転モード
4. **メディアファイルをスキャン** - クリックして全メディアファイルをスキャン・プレビュー
5. **個別設定を調整（オプション）** - 各ファイルの行を展開して個別に設定を変更可能
6. **処理 & リネーム** - クリックしてファイルを整理・リネーム

すべての高度な機能（バースト検出、EXIF回転補正など）は自動的に実行されます。

### 処理後

- **処理サマリー** - 処理完了後、成功/失敗/スキップのカウントが表示されます
- **失敗ファイルの確認** - 失敗したファイルをクリックすると、そのファイルにスクロールします
- **再処理** - 失敗したファイルのみを再処理する「Retry Failed Files」ボタンが利用可能
- **ログ確認** - 「Show Logs」ボタンでログを確認可能

### ディレクトリ検証

アプリは以下をチェックします：
- **出力が入力の中にある場合** → エラー（無限ループの危険）
- **入力と出力が同じ場合** → 警告（上書きモード、バックアップ推奨）

## 出力形式

### ファイル名
- **通常の写真**: `YYYYMMDD_HHmmss.ext`
- **バースト写真**: `YYYYMMDD_HHmmss_01.ext`, `_02.ext`, `_03.ext`, ...

### ディレクトリ構造
```
output/
├── 2025/
│   ├── 202501/
│   │   ├── 20250101/
│   │   │   ├── 20250101_120000.jpg
│   │   │   ├── 20250101_120001_01.jpg  # バースト
│   │   │   ├── 20250101_120001_02.jpg  # バースト
│   │   │   └── 20250101_143000.mp4
│   │   └── 20250102/
│   └── 202502/
```

## 設定

### デフォルト設定（UIで変更可能）

**写真のデフォルト:**
- 日付ソース: `Exif`（推奨）
- タイムゾーンオフセット: `exif`（EXIF から自動取得）
- 回転モード: `exif`（EXIF Orientation に従う）

**動画のデフォルト:**
- 日付ソース: `FileModified`（動画は EXIF が無い場合が多いため）
- タイムゾーンオフセット: `none`
- 回転モード: `none`

### 個別行設定（行を展開して変更可能）

各ファイルの行を展開すると、以下を個別に設定できます：
- **Date Source**: Exif / FileName / FileCreated / FileModified
- **Timezone Offset**: exif / none / +09:00 など
- **Rotation Mode**: none / exif / 90° / 180° / 270°

### バースト検出設定
デフォルト設定（`burst.rs` 内）:
- 最大間隔: 3秒
- 最小枚数: 3枚

### 処理オプション
すべてデフォルトで有効:
- `parallel: true` - マルチスレッド処理
- `include_videos: true` - 動画ファイルも処理
- `cleanup_temp: true` - 一時ファイル削除
- `auto_correct_orientation: true` - 画像回転修正

## 哲学

写真と思い出はあなたのものであり、巨大テック企業のものではありません。PhotoReturns は、標準化されたクラウド非依存のフォーマットでメディアファイルを整理することで、デジタルライフのコントロールを維持するのを支援します。

## ライセンス

MIT License

## 作者

kako-jun
